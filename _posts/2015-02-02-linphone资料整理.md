---
layout: post
title: "linphone资料整理"
date: 2015-02-02
comments: false
---
# linphone资料整理
February 2, 2015

## 依赖库
* bcg729 - g729语音编解码库
* belle-sip - SIP协议栈
* msamr - AMR即自适应多速率压缩（Adaptive multi-Rate compression）是一个使语音编码最优化的专利
* msilbc - iLBC是一种专为包交换网络通信设计的编解码，优于目前流行的G.729、G.723.1，对丢包进行了特有处理，即使在丢包率 相当高的网络环境下，仍可获得非常清晰的语音效果。
* msopenh264 - 思科的h264编解码器
* antlr3 - 语言识别的一个工具 (ANother Tool for Language Recognition ) 是一种语言工具，它提供了一个框架，可以通过包含 Java, C++, 或 C# 动作（action）的语法描述来构造语言识别器，编译器和解释器。
	* 安装方法:
	<pre>
	下载jar文件，并拷贝到/usr/share/java目录下
	sudo cp antlr-3.4-complete.jar /usr/share/java/antlr.jar
	</pre>
	** <font color=d80000>注意:必须是3.4，否则可能会报_empty不存在 </font> **


## Build
###  error: C compiler cannot create executables
* 问题
	<pre>
	checking whether the C compiler works... no
	configure: error: in `/Users/starnet/Projects/linphone-iphone/submodules/build-i386-apple-darwin/externals/polarssl':
	configure: error: C compiler cannot create executables
	</pre>
* 分析解决
	<pre>
	clang -std=c99 -Qunused-arguments -Wno-unknown-warning-option -Wno-unused-command-line-argument-hard-error-in-future  -arch i386  -isysroot /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator.sdk -mios-simulator-version-min=4.0 -DTARGET_OS_IPHONE=1 -D__IOS -fms-extensions -Dsha256=polarssl_sha256  -Dasm=__asm hello.c 
	ld: -pie can only be used when targeting iOS 4.2 or later
	clang: error: linker command failed with exit code 1 (use -v to see invocation)
	</pre>
	修改上述ios-simulator-version-min=4.2即可以通过编译
	于是修改submodules/build/iphone-config.site的SDK_VERSION
	<pre>
	SDK_VERSION_MAJOR=4                                                              
	SDK_VERSION=4.2   
	</pre>

### aclocal: error: aclocal: file 'm4/lt~obsolete.m4' does not exist
* 问题
	<pre>
	-e  Running autogen for msopus in /Users/starnet/Projects/linphone-iphone/submodules/build/..//externals/opus 
	cd /Users/starnet/Projects/linphone-iphone/submodules/build/..//externals/opus && ./autogen.sh
	Updating build configuration files, please wait....
	aclocal: error: aclocal: file 'm4/lt~obsolete.m4' does not exist
	autoreconf: aclocal failed with exit status: 1
	</pre>

* 分析解决

	分析发现/opt/local/share/aclocal/lt~obsolete.m4路径不存在，发现/usr/local/share/aclocal/存在，于是建立软连接
	<pre>
	sudo ln -s /usr/local/share/aclocal /opt/local/share/
	</pre>

### configure: error: GNU gettext tools not found; required for intltool
* 问题
	<pre>
	configure: error: GNU gettext tools not found; required for intltool
	</pre>
* 分析处理
	<pre>
	 sudo brew install gettext
	 sudo ln -s /usr/local/Cellar/gettext/0.19.3_1/bin/msgmerge /usr/local/bin/
	 sudo ln -s /usr/local/Cellar/gettext/0.19.3_1/bin/msgfmt /usr/local/bin/
	  sudo ln -s /usr/local/Cellar/gettext/0.19.3_1/bin/xgettext /usr/local/bin/
	</pre>
	
### 'CoreFoundation/CFUserNotification.h' file not found
* 问题
	<pre>
	In file included from /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator.sdk/System/Library/Frameworks/CFNetwork.framework/Headers/CFHost.h:22:
	/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator.sdk/System/Library/Frameworks/CoreFoundation.framework/Headers/CoreFoundation.h:92:10: fatal error: 
	      'CoreFoundation/CFUserNotification.h' file not found
	#include <CoreFoundation/CFUserNotification.h>
	</pre>
	
* 分析处理

	查看CoreFoundation.h文件，发现TARGET_OS_IPHONE被重置为0，经过寻找是由于CFBase.h中调用的TargetConditionals.h是来自于MacOSX10.10的SDK下面，后面发现是由于指定了C_INCLUDE_PATH
	<pre>
	declare -x C_INCLUDE_PATH="/Developer//Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.10.sdk/usr/include/"
	</pre>
	PS: 于是直接export C_INCLUDE_PATH = ""
---
layout: post
title: "微信分享SDK使用说明(IOS)"
date: 2015-01-13
comments: false
---
# 微信分享SDK使用说明(IOS)
January 13, 2015

## 1. 获取APPID
登录[微信开放平台](https://open.weixin.qq.com/)注册账号，并填写开放资质认证，之后就可以创建应用，并获取APPID

## 2. 获取SDK
SDK文件包括 libWeChatSDK.a，WXApi.h，WXApiObject.h 三个。

请前往“资源下载页”下载最新SDK包 

## 3. XCODE工程配置
* 进入要引用微信SDK的工程，引入SDK三个文件，并添加系统依赖库:

<pre>
SystemConfiguration.framework
libz.dylib
libsqlite3.0.dylib
</pre>
* 在TARGET的info标签栏的"URL type"添加"URL scheme" 为你所注册的应用程序id.(供微信界面返回自己的APP)

## 4. Coding
* 注册
<pre>
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions {
    [WXApi registerApp:@"wxbe41ebca760466e"];
    return YES;
}
</pre>

* 处理
<pre>
- (BOOL)application:(UIApplication *)application handleOpenURL:(NSURL *)url {
    return [WXApi handleOpenURL:url delegate:self];
}

- (BOOL)application:(UIApplication *)application openURL:(NSURL *)url sourceApplication:(NSString *)sourceApplication annotation:(id)annotation {
    return [WXApi handleOpenURL:url delegate:self];
}
</pre>

* 回调(或代理)
需要在AppDelegate中添加WXApiDelegate协议
<pre>
-(void) onReq:(BaseReq*)req {
    NSLog(@"请求的回调");
}

-(void) onResp:(BaseResp*)resp {
    NSLog(@"回复:%@", resp);
}
</pre>

* 发送信息
<pre>
    WXMediaMessage *message = [WXMediaMessage message];
    message.title = @"hello";
    message.description = @"world";
    [message setThumbImage:[UIImage imageNamed:@"ico"]];
    
    WXWebpageObject *ext = [WXWebpageObject object];
    ext.webpageUrl = @"http://www.baidu.com";
    
    message.mediaObject = ext;
    
    SendMessageToWXReq* req = [[SendMessageToWXReq alloc] init];
    req.bText = NO;
    req.message = message;
    req.scene = WXSceneSession;
    
    [WXApi sendReq:req];
</pre>

## DEMO
如下是测试的APPID和URL scheme
<pre>
APPID: wxbe41ebca760466e
URL scheme:wxbe41ebca760466e
</pre>